{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport { extent, max, median, min, range as d3Range } from 'd3-array';\nimport { stack, stackOffsetNone } from 'd3-shape';\nimport { scaleLinear, scaleLog, scaleTime, scaleUtc, scaleBand } from 'd3-scale';\n\nfunction defaultAxisOptions(options) {\n  var _options$elementType, _options$minTickPaddi, _options$tickLabelRot, _options$innerBandPad, _options$outerBandPad, _options$innerSeriesB, _options$outerSeriesB, _options$show, _options$stacked, _options$shouldNice;\n\n  return _extends({}, options, {\n    elementType: (_options$elementType = options.elementType) != null ? _options$elementType : 'line',\n    minTickPaddingForRotation: (_options$minTickPaddi = options.minTickPaddingForRotation) != null ? _options$minTickPaddi : 10,\n    tickLabelRotationDeg: (_options$tickLabelRot = options.tickLabelRotationDeg) != null ? _options$tickLabelRot : 60,\n    innerBandPadding: (_options$innerBandPad = options.innerBandPadding) != null ? _options$innerBandPad : 0.5,\n    outerBandPadding: (_options$outerBandPad = options.outerBandPadding) != null ? _options$outerBandPad : 0.2,\n    innerSeriesBandPadding: (_options$innerSeriesB = options.innerSeriesBandPadding) != null ? _options$innerSeriesB : 0.2,\n    outerSeriesBandPadding: (_options$outerSeriesB = options.outerSeriesBandPadding) != null ? _options$outerSeriesB : 0,\n    show: (_options$show = options.show) != null ? _options$show : true,\n    stacked: (_options$stacked = options.stacked) != null ? _options$stacked : false,\n    shouldNice: (_options$shouldNice = options.shouldNice) != null ? _options$shouldNice : true\n  });\n}\n\nexport default function buildAxisLinear(isPrimary, userOptions, series, allDatums, gridDimensions, width, height) {\n  var options = defaultAxisOptions(userOptions);\n\n  if (!options.position) {\n    throw new Error(\"Chart axes must have a valid 'position' property\");\n  }\n\n  var isVertical = ['left', 'right'].indexOf(options.position) > -1; // Now we need to figure out the range\n\n  var range = isVertical ? [gridDimensions.height, 0] : [0, gridDimensions.width];\n  var outerRange = isVertical ? [height, 0] : [0, width]; // Give the scale a home\n\n  return options.scaleType === 'time' || options.scaleType === 'localTime' ? buildTimeAxis(isPrimary, options, series, allDatums, isVertical, range, outerRange) : options.scaleType === 'linear' || options.scaleType === 'log' ? buildLinearAxis(isPrimary, options, series, allDatums, isVertical, range, outerRange) : options.scaleType === 'band' ? buildBandAxis(isPrimary, options, series, isVertical, range, outerRange) : function () {\n    throw new Error('Invalid scale type');\n  }();\n}\n\nfunction buildTimeAxis(isPrimary, options, series, allDatums, isVertical, range, outerRange) {\n  var scaleFn = options.scaleType === 'localTime' ? scaleTime : scaleUtc;\n  var isInvalid = false; // Now set the range\n\n  var scale = scaleFn(range);\n\n  var _extent = extent(allDatums, function (datum) {\n    var value = options.getValue(datum.originalDatum);\n    datum[isPrimary ? 'primaryValue' : 'secondaryValue'] = value;\n    return value;\n  }),\n      minValue = _extent[0],\n      maxValue = _extent[1];\n\n  var shouldNice = options.shouldNice; // see https://stackoverflow.com/a/2831422\n\n  if (Object.prototype.toString.call(options.min) === '[object Date]') {\n    minValue = min([options.min, minValue]);\n    shouldNice = false;\n  }\n\n  if (Object.prototype.toString.call(options.max) === '[object Date]') {\n    maxValue = max([options.max, maxValue]);\n    shouldNice = false;\n  }\n\n  if (Object.prototype.toString.call(options.hardMin) === '[object Date]') {\n    minValue = options.hardMin;\n    shouldNice = false;\n  }\n\n  if (Object.prototype.toString.call(options.hardMax) === '[object Date]') {\n    maxValue = options.hardMax;\n    shouldNice = false;\n  }\n\n  if (minValue === undefined || maxValue === undefined) {\n    console.info('Invalid scale min/max was detect for a chart:', {\n      options: options,\n      series: series,\n      range: range,\n      values: allDatums.map(function (d) {\n        return isPrimary ? d.primaryValue : d.secondaryValue;\n      })\n    });\n    isInvalid = true;\n  } // Set the domain\n\n\n  scale.domain([minValue, maxValue]);\n\n  if (options.invert) {\n    scale.domain(Array.from(scale.domain()).reverse());\n  }\n\n  if (shouldNice) {\n    scale.nice();\n  }\n\n  var outerScale = scale.copy().range(outerRange); // Supplmentary band scale\n\n  var primaryBandScale = isPrimary ? buildPrimaryBandScale(options, scale, series, range) : undefined;\n  var seriesBandScale = primaryBandScale ? buildSeriesBandScale(options, primaryBandScale, series) : undefined;\n  var defaultFormat = scale.tickFormat();\n  var formatters = {};\n\n  var scaleFormat = function scaleFormat(value) {\n    var _options$formatters$s, _options$formatters;\n\n    return (_options$formatters$s = (_options$formatters = options.formatters) == null ? void 0 : _options$formatters.scale == null ? void 0 : _options$formatters.scale(value, _extends({}, formatters, {\n      scale: undefined\n    }))) != null ? _options$formatters$s : defaultFormat(value);\n  };\n\n  var tooltipFormat = function tooltipFormat(value) {\n    var _options$formatters$t, _options$formatters2;\n\n    return (_options$formatters$t = (_options$formatters2 = options.formatters) == null ? void 0 : _options$formatters2.tooltip == null ? void 0 : _options$formatters2.tooltip(value, _extends({}, formatters, {\n      tooltip: undefined\n    }))) != null ? _options$formatters$t : scaleFormat(value);\n  };\n\n  var cursorFormat = function cursorFormat(value) {\n    var _options$formatters$c, _options$formatters3;\n\n    return (_options$formatters$c = (_options$formatters3 = options.formatters) == null ? void 0 : _options$formatters3.cursor == null ? void 0 : _options$formatters3.cursor(value, _extends({}, formatters, {\n      cursor: undefined\n    }))) != null ? _options$formatters$c : tooltipFormat(value);\n  };\n\n  Object.assign(formatters, {\n    \"default\": defaultFormat,\n    scale: scaleFormat,\n    tooltip: tooltipFormat,\n    cursor: cursorFormat\n  });\n  return _extends({}, options, {\n    isInvalid: isInvalid,\n    axisFamily: 'time',\n    isVertical: isVertical,\n    scale: scale,\n    range: range,\n    outerScale: outerScale,\n    primaryBandScale: primaryBandScale,\n    seriesBandScale: seriesBandScale,\n    formatters: formatters\n  });\n}\n\nfunction buildLinearAxis(isPrimary, options, series, allDatums, isVertical, range, outerRange) {\n  var scale = options.scaleType === 'log' ? scaleLog() : scaleLinear();\n  var isInvalid = false;\n\n  if (options.stacked) {\n    stackSeries(series, options);\n  }\n\n  var _ref = options.stacked ? extent(series.map(function (s) {\n    return s.datums.map(function (datum) {\n      var _datum$stackData;\n\n      var value = options.getValue(datum.originalDatum);\n      datum[isPrimary ? 'primaryValue' : 'secondaryValue'] = value;\n      return (_datum$stackData = datum.stackData) != null ? _datum$stackData : [];\n    });\n  }).flat(2)) : extent(allDatums, function (datum) {\n    var value = options.getValue(datum.originalDatum);\n    datum[isPrimary ? 'primaryValue' : 'secondaryValue'] = value;\n    return value;\n  }),\n      minValue = _ref[0],\n      maxValue = _ref[1];\n\n  var shouldNice = options.shouldNice;\n\n  if (typeof options.min === 'number') {\n    minValue = min([options.min, minValue]);\n    shouldNice = false;\n  }\n\n  if (typeof options.max === 'number') {\n    maxValue = max([options.max, maxValue]);\n    shouldNice = false;\n  }\n\n  if (typeof options.minDomainLength === 'number' && !(minValue === undefined || maxValue === undefined)) {\n    var mid = median([minValue, maxValue]);\n    var top = mid + options.minDomainLength / 2;\n    var bottom = mid - options.minDomainLength / 2;\n    maxValue = Math.max(top, maxValue);\n    minValue = Math.min(bottom, minValue);\n  }\n\n  if (typeof options.hardMin === 'number') {\n    minValue = options.hardMin;\n    shouldNice = false;\n  }\n\n  if (typeof options.hardMax === 'number') {\n    maxValue = options.hardMax;\n    shouldNice = false;\n  }\n\n  if (minValue === undefined || maxValue === undefined) {\n    var _minValue, _maxValue;\n\n    isInvalid = true;\n    console.info('Invalid scale min/max', {\n      options: options,\n      series: series,\n      range: range,\n      values: allDatums.map(function (d) {\n        return isPrimary ? d.primaryValue : d.secondaryValue;\n      })\n    });\n    minValue = (_minValue = minValue) != null ? _minValue : 0;\n    maxValue = (_maxValue = maxValue) != null ? _maxValue : 0; // throw new Error('Invalid scale min/max')\n  } // Set the domain\n\n\n  scale.domain([minValue, maxValue]);\n\n  if (options.invert) {\n    scale.domain(Array.from(scale.domain()).reverse());\n  }\n\n  scale.range(range);\n\n  if (shouldNice) {\n    scale.nice();\n  }\n\n  var outerScale = scale.copy().range(outerRange);\n  var primaryBandScale = isPrimary ? buildPrimaryBandScale(options, scale, series, range) : undefined;\n  var seriesBandScale = primaryBandScale ? buildSeriesBandScale(options, primaryBandScale, series) : undefined;\n  var defaultFormat = scale.tickFormat();\n  var formatters = {};\n\n  var scaleFormat = function scaleFormat(value) {\n    var _options$formatters$s2, _options$formatters4;\n\n    return (_options$formatters$s2 = (_options$formatters4 = options.formatters) == null ? void 0 : _options$formatters4.scale == null ? void 0 : _options$formatters4.scale(value, _extends({}, formatters, {\n      scale: undefined\n    }))) != null ? _options$formatters$s2 : defaultFormat(value);\n  };\n\n  var tooltipFormat = function tooltipFormat(value) {\n    var _options$formatters$t2, _options$formatters5;\n\n    return (_options$formatters$t2 = (_options$formatters5 = options.formatters) == null ? void 0 : _options$formatters5.tooltip == null ? void 0 : _options$formatters5.tooltip(value, _extends({}, formatters, {\n      tooltip: undefined\n    }))) != null ? _options$formatters$t2 : scaleFormat(value);\n  };\n\n  var cursorFormat = function cursorFormat(value) {\n    var _options$formatters$c2, _options$formatters6;\n\n    return (_options$formatters$c2 = (_options$formatters6 = options.formatters) == null ? void 0 : _options$formatters6.cursor == null ? void 0 : _options$formatters6.cursor(value, _extends({}, formatters, {\n      cursor: undefined\n    }))) != null ? _options$formatters$c2 : tooltipFormat(value);\n  };\n\n  Object.assign(formatters, {\n    \"default\": defaultFormat,\n    scale: scaleFormat,\n    tooltip: tooltipFormat,\n    cursor: cursorFormat\n  });\n  return _extends({}, options, {\n    isInvalid: isInvalid,\n    axisFamily: 'linear',\n    isVertical: isVertical,\n    scale: scale,\n    range: range,\n    outerScale: outerScale,\n    primaryBandScale: primaryBandScale,\n    seriesBandScale: seriesBandScale,\n    formatters: formatters\n  });\n}\n\nfunction buildBandAxis(isPrimary, options, series, isVertical, range, outerRange) {\n  var _options$outerBandPad2, _options$innerBandPad2;\n\n  series = series.filter(function (d) {\n    return d.secondaryAxisId === options.id;\n  });\n  var isInvalid = false;\n  var domain = Array.from(new Set(series.map(function (d) {\n    return d.datums;\n  }).flat().map(function (datum) {\n    var value = options.getValue(datum.originalDatum);\n    datum[isPrimary ? 'primaryValue' : 'secondaryValue'] = value;\n    return value;\n  })));\n  var scale = scaleBand(domain, range).round(false).paddingOuter((_options$outerBandPad2 = options.outerBandPadding) != null ? _options$outerBandPad2 : 0).paddingInner((_options$innerBandPad2 = options.innerBandPadding) != null ? _options$innerBandPad2 : 0); // Invert if necessary\n\n  if (options.invert) {\n    scale.domain(Array.from(scale.domain()).reverse());\n  }\n\n  var outerScale = scale.copy().range(outerRange);\n  var primaryBandScale = scale;\n  var seriesBandScale = buildSeriesBandScale(options, primaryBandScale, series);\n\n  var defaultFormat = function defaultFormat(d) {\n    return d;\n  };\n\n  var formatters = {};\n\n  var scaleFormat = function scaleFormat(value) {\n    var _options$formatters$s3, _options$formatters7;\n\n    return (_options$formatters$s3 = (_options$formatters7 = options.formatters) == null ? void 0 : _options$formatters7.scale == null ? void 0 : _options$formatters7.scale(value, _extends({}, formatters, {\n      scale: undefined\n    }))) != null ? _options$formatters$s3 : defaultFormat(value);\n  };\n\n  var tooltipFormat = function tooltipFormat(value) {\n    var _options$formatters$t3, _options$formatters8;\n\n    return (_options$formatters$t3 = (_options$formatters8 = options.formatters) == null ? void 0 : _options$formatters8.tooltip == null ? void 0 : _options$formatters8.tooltip(value, _extends({}, formatters, {\n      tooltip: undefined\n    }))) != null ? _options$formatters$t3 : scaleFormat(value);\n  };\n\n  var cursorFormat = function cursorFormat(value) {\n    var _options$formatters$c3, _options$formatters9;\n\n    return (_options$formatters$c3 = (_options$formatters9 = options.formatters) == null ? void 0 : _options$formatters9.cursor == null ? void 0 : _options$formatters9.cursor(value, _extends({}, formatters, {\n      cursor: undefined\n    }))) != null ? _options$formatters$c3 : tooltipFormat(value);\n  };\n\n  Object.assign(formatters, {\n    \"default\": defaultFormat,\n    scale: scaleFormat,\n    tooltip: tooltipFormat,\n    cursor: cursorFormat\n  });\n  return _extends({}, options, {\n    isInvalid: isInvalid,\n    axisFamily: 'band',\n    isVertical: isVertical,\n    scale: scale,\n    range: range,\n    outerScale: outerScale,\n    formatters: formatters,\n    primaryBandScale: primaryBandScale,\n    seriesBandScale: seriesBandScale\n  });\n} //\n\n\nfunction stackSeries(series, axisOptions) {\n  var _axisOptions$stackOff;\n\n  var axisSeries = series.filter(function (s) {\n    return s.secondaryAxisId === axisOptions.id;\n  });\n  var seriesIndices = Object.keys(axisSeries);\n  var stacker = stack().keys(seriesIndices).value(function (_, seriesIndex, index) {\n    var _axisSeries$Number, _axisSeries$Number$da;\n\n    var originalDatum = (_axisSeries$Number = axisSeries[Number(seriesIndex)]) == null ? void 0 : (_axisSeries$Number$da = _axisSeries$Number.datums[index]) == null ? void 0 : _axisSeries$Number$da.originalDatum;\n    var val = typeof originalDatum !== 'undefined' ? axisOptions.getValue(originalDatum) : 0;\n\n    if (typeof val === 'undefined' || val === null) {\n      return 0;\n    }\n\n    return val;\n  }).offset((_axisOptions$stackOff = axisOptions.stackOffset) != null ? _axisOptions$stackOff : stackOffsetNone);\n  var stacked = stacker(Array.from({\n    length: axisSeries.sort(function (a, b) {\n      return b.datums.length - a.datums.length;\n    })[0].datums.length\n  }));\n  stacked.forEach(function (s, sIndex) {\n    s.forEach(function (datum, i) {\n      if (axisSeries[sIndex].datums[i]) {\n        // @ts-ignore\n        datum.data = axisSeries[sIndex].datums[i];\n        axisSeries[sIndex].datums[i].stackData = datum;\n      }\n    });\n  });\n}\n\nfunction buildPrimaryBandScale(options, scale, series, range) {\n  var _options$outerBandPad3, _options$innerBandPad3; // Find the two closest points along axis\n\n\n  var impliedBandWidth = Math.max.apply(Math, range);\n  series.forEach(function (serie) {\n    serie.datums.forEach(function (d1) {\n      var _d1$primaryValue;\n\n      var one = scale((_d1$primaryValue = d1.primaryValue) != null ? _d1$primaryValue : NaN);\n      serie.datums.forEach(function (d2) {\n        var _d2$primaryValue;\n\n        var two = scale((_d2$primaryValue = d2.primaryValue) != null ? _d2$primaryValue : NaN);\n\n        if (one === two) {\n          return;\n        }\n\n        var diff = Math.abs(Math.max(one, two) - Math.min(one, two));\n\n        if (diff < impliedBandWidth) {\n          impliedBandWidth = diff;\n        }\n      });\n    });\n  });\n  var bandRange = Math.max.apply(Math, range);\n  var bandDomain = d3Range(bandRange / impliedBandWidth);\n  var primaryBandScale = scaleBand(bandDomain, range).round(false).paddingOuter((_options$outerBandPad3 = options.outerBandPadding) != null ? _options$outerBandPad3 : 0).paddingInner((_options$innerBandPad3 = options.innerBandPadding) != null ? _options$innerBandPad3 : 0);\n  return primaryBandScale;\n}\n\nfunction buildSeriesBandScale(options, primaryBandScale, series) {\n  var _options$outerSeriesB2, _options$innerSeriesB2;\n\n  var bandDomain = d3Range(series.filter(function (d) {\n    return d.secondaryAxisId === options.id;\n  }).length);\n  var seriesBandScale = scaleBand(bandDomain, [0, primaryBandScale.bandwidth()]).round(false).paddingOuter((_options$outerSeriesB2 = options.outerSeriesBandPadding) != null ? _options$outerSeriesB2 : options.outerBandPadding ? options.outerBandPadding / 2 : 0).paddingInner((_options$innerSeriesB2 = options.innerSeriesBandPadding) != null ? _options$innerSeriesB2 : options.innerBandPadding ? options.innerBandPadding / 2 : 0);\n\n  var scale = function scale(seriesIndex) {\n    var _series$find;\n\n    return seriesBandScale((_series$find = series.find(function (d) {\n      return d.index === seriesIndex;\n    })) == null ? void 0 : _series$find.indexPerAxis);\n  };\n\n  return Object.assign(scale, seriesBandScale);\n}","map":{"version":3,"sources":["/home/ralph1/Documents/3rd_year/software_eng/react/github_visaulisation/node_modules/react-charts/es/utils/buildAxis.linear.js"],"names":["_extends","extent","max","median","min","range","d3Range","stack","stackOffsetNone","scaleLinear","scaleLog","scaleTime","scaleUtc","scaleBand","defaultAxisOptions","options","_options$elementType","_options$minTickPaddi","_options$tickLabelRot","_options$innerBandPad","_options$outerBandPad","_options$innerSeriesB","_options$outerSeriesB","_options$show","_options$stacked","_options$shouldNice","elementType","minTickPaddingForRotation","tickLabelRotationDeg","innerBandPadding","outerBandPadding","innerSeriesBandPadding","outerSeriesBandPadding","show","stacked","shouldNice","buildAxisLinear","isPrimary","userOptions","series","allDatums","gridDimensions","width","height","position","Error","isVertical","indexOf","outerRange","scaleType","buildTimeAxis","buildLinearAxis","buildBandAxis","scaleFn","isInvalid","scale","_extent","datum","value","getValue","originalDatum","minValue","maxValue","Object","prototype","toString","call","hardMin","hardMax","undefined","console","info","values","map","d","primaryValue","secondaryValue","domain","invert","Array","from","reverse","nice","outerScale","copy","primaryBandScale","buildPrimaryBandScale","seriesBandScale","buildSeriesBandScale","defaultFormat","tickFormat","formatters","scaleFormat","_options$formatters$s","_options$formatters","tooltipFormat","_options$formatters$t","_options$formatters2","tooltip","cursorFormat","_options$formatters$c","_options$formatters3","cursor","assign","axisFamily","stackSeries","_ref","s","datums","_datum$stackData","stackData","flat","minDomainLength","mid","top","bottom","Math","_minValue","_maxValue","_options$formatters$s2","_options$formatters4","_options$formatters$t2","_options$formatters5","_options$formatters$c2","_options$formatters6","_options$outerBandPad2","_options$innerBandPad2","filter","secondaryAxisId","id","Set","round","paddingOuter","paddingInner","_options$formatters$s3","_options$formatters7","_options$formatters$t3","_options$formatters8","_options$formatters$c3","_options$formatters9","axisOptions","_axisOptions$stackOff","axisSeries","seriesIndices","keys","stacker","_","seriesIndex","index","_axisSeries$Number","_axisSeries$Number$da","Number","val","offset","stackOffset","length","sort","a","b","forEach","sIndex","i","data","_options$outerBandPad3","_options$innerBandPad3","impliedBandWidth","apply","serie","d1","_d1$primaryValue","one","NaN","d2","_d2$primaryValue","two","diff","abs","bandRange","bandDomain","_options$outerSeriesB2","_options$innerSeriesB2","bandwidth","_series$find","find","indexPerAxis"],"mappings":"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","sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport { extent, max, median, min, range as d3Range } from 'd3-array';\nimport { stack, stackOffsetNone } from 'd3-shape';\nimport { scaleLinear, scaleLog, scaleTime, scaleUtc, scaleBand } from 'd3-scale';\n\nfunction defaultAxisOptions(options) {\n  var _options$elementType, _options$minTickPaddi, _options$tickLabelRot, _options$innerBandPad, _options$outerBandPad, _options$innerSeriesB, _options$outerSeriesB, _options$show, _options$stacked, _options$shouldNice;\n\n  return _extends({}, options, {\n    elementType: (_options$elementType = options.elementType) != null ? _options$elementType : 'line',\n    minTickPaddingForRotation: (_options$minTickPaddi = options.minTickPaddingForRotation) != null ? _options$minTickPaddi : 10,\n    tickLabelRotationDeg: (_options$tickLabelRot = options.tickLabelRotationDeg) != null ? _options$tickLabelRot : 60,\n    innerBandPadding: (_options$innerBandPad = options.innerBandPadding) != null ? _options$innerBandPad : 0.5,\n    outerBandPadding: (_options$outerBandPad = options.outerBandPadding) != null ? _options$outerBandPad : 0.2,\n    innerSeriesBandPadding: (_options$innerSeriesB = options.innerSeriesBandPadding) != null ? _options$innerSeriesB : 0.2,\n    outerSeriesBandPadding: (_options$outerSeriesB = options.outerSeriesBandPadding) != null ? _options$outerSeriesB : 0,\n    show: (_options$show = options.show) != null ? _options$show : true,\n    stacked: (_options$stacked = options.stacked) != null ? _options$stacked : false,\n    shouldNice: (_options$shouldNice = options.shouldNice) != null ? _options$shouldNice : true\n  });\n}\n\nexport default function buildAxisLinear(isPrimary, userOptions, series, allDatums, gridDimensions, width, height) {\n  var options = defaultAxisOptions(userOptions);\n\n  if (!options.position) {\n    throw new Error(\"Chart axes must have a valid 'position' property\");\n  }\n\n  var isVertical = ['left', 'right'].indexOf(options.position) > -1; // Now we need to figure out the range\n\n  var range = isVertical ? [gridDimensions.height, 0] : [0, gridDimensions.width];\n  var outerRange = isVertical ? [height, 0] : [0, width]; // Give the scale a home\n\n  return options.scaleType === 'time' || options.scaleType === 'localTime' ? buildTimeAxis(isPrimary, options, series, allDatums, isVertical, range, outerRange) : options.scaleType === 'linear' || options.scaleType === 'log' ? buildLinearAxis(isPrimary, options, series, allDatums, isVertical, range, outerRange) : options.scaleType === 'band' ? buildBandAxis(isPrimary, options, series, isVertical, range, outerRange) : function () {\n    throw new Error('Invalid scale type');\n  }();\n}\n\nfunction buildTimeAxis(isPrimary, options, series, allDatums, isVertical, range, outerRange) {\n  var scaleFn = options.scaleType === 'localTime' ? scaleTime : scaleUtc;\n  var isInvalid = false; // Now set the range\n\n  var scale = scaleFn(range);\n\n  var _extent = extent(allDatums, function (datum) {\n    var value = options.getValue(datum.originalDatum);\n    datum[isPrimary ? 'primaryValue' : 'secondaryValue'] = value;\n    return value;\n  }),\n      minValue = _extent[0],\n      maxValue = _extent[1];\n\n  var shouldNice = options.shouldNice; // see https://stackoverflow.com/a/2831422\n\n  if (Object.prototype.toString.call(options.min) === '[object Date]') {\n    minValue = min([options.min, minValue]);\n    shouldNice = false;\n  }\n\n  if (Object.prototype.toString.call(options.max) === '[object Date]') {\n    maxValue = max([options.max, maxValue]);\n    shouldNice = false;\n  }\n\n  if (Object.prototype.toString.call(options.hardMin) === '[object Date]') {\n    minValue = options.hardMin;\n    shouldNice = false;\n  }\n\n  if (Object.prototype.toString.call(options.hardMax) === '[object Date]') {\n    maxValue = options.hardMax;\n    shouldNice = false;\n  }\n\n  if (minValue === undefined || maxValue === undefined) {\n    console.info('Invalid scale min/max was detect for a chart:', {\n      options: options,\n      series: series,\n      range: range,\n      values: allDatums.map(function (d) {\n        return isPrimary ? d.primaryValue : d.secondaryValue;\n      })\n    });\n    isInvalid = true;\n  } // Set the domain\n\n\n  scale.domain([minValue, maxValue]);\n\n  if (options.invert) {\n    scale.domain(Array.from(scale.domain()).reverse());\n  }\n\n  if (shouldNice) {\n    scale.nice();\n  }\n\n  var outerScale = scale.copy().range(outerRange); // Supplmentary band scale\n\n  var primaryBandScale = isPrimary ? buildPrimaryBandScale(options, scale, series, range) : undefined;\n  var seriesBandScale = primaryBandScale ? buildSeriesBandScale(options, primaryBandScale, series) : undefined;\n  var defaultFormat = scale.tickFormat();\n  var formatters = {};\n\n  var scaleFormat = function scaleFormat(value) {\n    var _options$formatters$s, _options$formatters;\n\n    return (_options$formatters$s = (_options$formatters = options.formatters) == null ? void 0 : _options$formatters.scale == null ? void 0 : _options$formatters.scale(value, _extends({}, formatters, {\n      scale: undefined\n    }))) != null ? _options$formatters$s : defaultFormat(value);\n  };\n\n  var tooltipFormat = function tooltipFormat(value) {\n    var _options$formatters$t, _options$formatters2;\n\n    return (_options$formatters$t = (_options$formatters2 = options.formatters) == null ? void 0 : _options$formatters2.tooltip == null ? void 0 : _options$formatters2.tooltip(value, _extends({}, formatters, {\n      tooltip: undefined\n    }))) != null ? _options$formatters$t : scaleFormat(value);\n  };\n\n  var cursorFormat = function cursorFormat(value) {\n    var _options$formatters$c, _options$formatters3;\n\n    return (_options$formatters$c = (_options$formatters3 = options.formatters) == null ? void 0 : _options$formatters3.cursor == null ? void 0 : _options$formatters3.cursor(value, _extends({}, formatters, {\n      cursor: undefined\n    }))) != null ? _options$formatters$c : tooltipFormat(value);\n  };\n\n  Object.assign(formatters, {\n    \"default\": defaultFormat,\n    scale: scaleFormat,\n    tooltip: tooltipFormat,\n    cursor: cursorFormat\n  });\n  return _extends({}, options, {\n    isInvalid: isInvalid,\n    axisFamily: 'time',\n    isVertical: isVertical,\n    scale: scale,\n    range: range,\n    outerScale: outerScale,\n    primaryBandScale: primaryBandScale,\n    seriesBandScale: seriesBandScale,\n    formatters: formatters\n  });\n}\n\nfunction buildLinearAxis(isPrimary, options, series, allDatums, isVertical, range, outerRange) {\n  var scale = options.scaleType === 'log' ? scaleLog() : scaleLinear();\n  var isInvalid = false;\n\n  if (options.stacked) {\n    stackSeries(series, options);\n  }\n\n  var _ref = options.stacked ? extent(series.map(function (s) {\n    return s.datums.map(function (datum) {\n      var _datum$stackData;\n\n      var value = options.getValue(datum.originalDatum);\n      datum[isPrimary ? 'primaryValue' : 'secondaryValue'] = value;\n      return (_datum$stackData = datum.stackData) != null ? _datum$stackData : [];\n    });\n  }).flat(2)) : extent(allDatums, function (datum) {\n    var value = options.getValue(datum.originalDatum);\n    datum[isPrimary ? 'primaryValue' : 'secondaryValue'] = value;\n    return value;\n  }),\n      minValue = _ref[0],\n      maxValue = _ref[1];\n\n  var shouldNice = options.shouldNice;\n\n  if (typeof options.min === 'number') {\n    minValue = min([options.min, minValue]);\n    shouldNice = false;\n  }\n\n  if (typeof options.max === 'number') {\n    maxValue = max([options.max, maxValue]);\n    shouldNice = false;\n  }\n\n  if (typeof options.minDomainLength === 'number' && !(minValue === undefined || maxValue === undefined)) {\n    var mid = median([minValue, maxValue]);\n    var top = mid + options.minDomainLength / 2;\n    var bottom = mid - options.minDomainLength / 2;\n    maxValue = Math.max(top, maxValue);\n    minValue = Math.min(bottom, minValue);\n  }\n\n  if (typeof options.hardMin === 'number') {\n    minValue = options.hardMin;\n    shouldNice = false;\n  }\n\n  if (typeof options.hardMax === 'number') {\n    maxValue = options.hardMax;\n    shouldNice = false;\n  }\n\n  if (minValue === undefined || maxValue === undefined) {\n    var _minValue, _maxValue;\n\n    isInvalid = true;\n    console.info('Invalid scale min/max', {\n      options: options,\n      series: series,\n      range: range,\n      values: allDatums.map(function (d) {\n        return isPrimary ? d.primaryValue : d.secondaryValue;\n      })\n    });\n    minValue = (_minValue = minValue) != null ? _minValue : 0;\n    maxValue = (_maxValue = maxValue) != null ? _maxValue : 0; // throw new Error('Invalid scale min/max')\n  } // Set the domain\n\n\n  scale.domain([minValue, maxValue]);\n\n  if (options.invert) {\n    scale.domain(Array.from(scale.domain()).reverse());\n  }\n\n  scale.range(range);\n\n  if (shouldNice) {\n    scale.nice();\n  }\n\n  var outerScale = scale.copy().range(outerRange);\n  var primaryBandScale = isPrimary ? buildPrimaryBandScale(options, scale, series, range) : undefined;\n  var seriesBandScale = primaryBandScale ? buildSeriesBandScale(options, primaryBandScale, series) : undefined;\n  var defaultFormat = scale.tickFormat();\n  var formatters = {};\n\n  var scaleFormat = function scaleFormat(value) {\n    var _options$formatters$s2, _options$formatters4;\n\n    return (_options$formatters$s2 = (_options$formatters4 = options.formatters) == null ? void 0 : _options$formatters4.scale == null ? void 0 : _options$formatters4.scale(value, _extends({}, formatters, {\n      scale: undefined\n    }))) != null ? _options$formatters$s2 : defaultFormat(value);\n  };\n\n  var tooltipFormat = function tooltipFormat(value) {\n    var _options$formatters$t2, _options$formatters5;\n\n    return (_options$formatters$t2 = (_options$formatters5 = options.formatters) == null ? void 0 : _options$formatters5.tooltip == null ? void 0 : _options$formatters5.tooltip(value, _extends({}, formatters, {\n      tooltip: undefined\n    }))) != null ? _options$formatters$t2 : scaleFormat(value);\n  };\n\n  var cursorFormat = function cursorFormat(value) {\n    var _options$formatters$c2, _options$formatters6;\n\n    return (_options$formatters$c2 = (_options$formatters6 = options.formatters) == null ? void 0 : _options$formatters6.cursor == null ? void 0 : _options$formatters6.cursor(value, _extends({}, formatters, {\n      cursor: undefined\n    }))) != null ? _options$formatters$c2 : tooltipFormat(value);\n  };\n\n  Object.assign(formatters, {\n    \"default\": defaultFormat,\n    scale: scaleFormat,\n    tooltip: tooltipFormat,\n    cursor: cursorFormat\n  });\n  return _extends({}, options, {\n    isInvalid: isInvalid,\n    axisFamily: 'linear',\n    isVertical: isVertical,\n    scale: scale,\n    range: range,\n    outerScale: outerScale,\n    primaryBandScale: primaryBandScale,\n    seriesBandScale: seriesBandScale,\n    formatters: formatters\n  });\n}\n\nfunction buildBandAxis(isPrimary, options, series, isVertical, range, outerRange) {\n  var _options$outerBandPad2, _options$innerBandPad2;\n\n  series = series.filter(function (d) {\n    return d.secondaryAxisId === options.id;\n  });\n  var isInvalid = false;\n  var domain = Array.from(new Set(series.map(function (d) {\n    return d.datums;\n  }).flat().map(function (datum) {\n    var value = options.getValue(datum.originalDatum);\n    datum[isPrimary ? 'primaryValue' : 'secondaryValue'] = value;\n    return value;\n  })));\n  var scale = scaleBand(domain, range).round(false).paddingOuter((_options$outerBandPad2 = options.outerBandPadding) != null ? _options$outerBandPad2 : 0).paddingInner((_options$innerBandPad2 = options.innerBandPadding) != null ? _options$innerBandPad2 : 0); // Invert if necessary\n\n  if (options.invert) {\n    scale.domain(Array.from(scale.domain()).reverse());\n  }\n\n  var outerScale = scale.copy().range(outerRange);\n  var primaryBandScale = scale;\n  var seriesBandScale = buildSeriesBandScale(options, primaryBandScale, series);\n\n  var defaultFormat = function defaultFormat(d) {\n    return d;\n  };\n\n  var formatters = {};\n\n  var scaleFormat = function scaleFormat(value) {\n    var _options$formatters$s3, _options$formatters7;\n\n    return (_options$formatters$s3 = (_options$formatters7 = options.formatters) == null ? void 0 : _options$formatters7.scale == null ? void 0 : _options$formatters7.scale(value, _extends({}, formatters, {\n      scale: undefined\n    }))) != null ? _options$formatters$s3 : defaultFormat(value);\n  };\n\n  var tooltipFormat = function tooltipFormat(value) {\n    var _options$formatters$t3, _options$formatters8;\n\n    return (_options$formatters$t3 = (_options$formatters8 = options.formatters) == null ? void 0 : _options$formatters8.tooltip == null ? void 0 : _options$formatters8.tooltip(value, _extends({}, formatters, {\n      tooltip: undefined\n    }))) != null ? _options$formatters$t3 : scaleFormat(value);\n  };\n\n  var cursorFormat = function cursorFormat(value) {\n    var _options$formatters$c3, _options$formatters9;\n\n    return (_options$formatters$c3 = (_options$formatters9 = options.formatters) == null ? void 0 : _options$formatters9.cursor == null ? void 0 : _options$formatters9.cursor(value, _extends({}, formatters, {\n      cursor: undefined\n    }))) != null ? _options$formatters$c3 : tooltipFormat(value);\n  };\n\n  Object.assign(formatters, {\n    \"default\": defaultFormat,\n    scale: scaleFormat,\n    tooltip: tooltipFormat,\n    cursor: cursorFormat\n  });\n  return _extends({}, options, {\n    isInvalid: isInvalid,\n    axisFamily: 'band',\n    isVertical: isVertical,\n    scale: scale,\n    range: range,\n    outerScale: outerScale,\n    formatters: formatters,\n    primaryBandScale: primaryBandScale,\n    seriesBandScale: seriesBandScale\n  });\n} //\n\n\nfunction stackSeries(series, axisOptions) {\n  var _axisOptions$stackOff;\n\n  var axisSeries = series.filter(function (s) {\n    return s.secondaryAxisId === axisOptions.id;\n  });\n  var seriesIndices = Object.keys(axisSeries);\n  var stacker = stack().keys(seriesIndices).value(function (_, seriesIndex, index) {\n    var _axisSeries$Number, _axisSeries$Number$da;\n\n    var originalDatum = (_axisSeries$Number = axisSeries[Number(seriesIndex)]) == null ? void 0 : (_axisSeries$Number$da = _axisSeries$Number.datums[index]) == null ? void 0 : _axisSeries$Number$da.originalDatum;\n    var val = typeof originalDatum !== 'undefined' ? axisOptions.getValue(originalDatum) : 0;\n\n    if (typeof val === 'undefined' || val === null) {\n      return 0;\n    }\n\n    return val;\n  }).offset((_axisOptions$stackOff = axisOptions.stackOffset) != null ? _axisOptions$stackOff : stackOffsetNone);\n  var stacked = stacker(Array.from({\n    length: axisSeries.sort(function (a, b) {\n      return b.datums.length - a.datums.length;\n    })[0].datums.length\n  }));\n  stacked.forEach(function (s, sIndex) {\n    s.forEach(function (datum, i) {\n      if (axisSeries[sIndex].datums[i]) {\n        // @ts-ignore\n        datum.data = axisSeries[sIndex].datums[i];\n        axisSeries[sIndex].datums[i].stackData = datum;\n      }\n    });\n  });\n}\n\nfunction buildPrimaryBandScale(options, scale, series, range) {\n  var _options$outerBandPad3, _options$innerBandPad3;\n\n  // Find the two closest points along axis\n  var impliedBandWidth = Math.max.apply(Math, range);\n  series.forEach(function (serie) {\n    serie.datums.forEach(function (d1) {\n      var _d1$primaryValue;\n\n      var one = scale((_d1$primaryValue = d1.primaryValue) != null ? _d1$primaryValue : NaN);\n      serie.datums.forEach(function (d2) {\n        var _d2$primaryValue;\n\n        var two = scale((_d2$primaryValue = d2.primaryValue) != null ? _d2$primaryValue : NaN);\n\n        if (one === two) {\n          return;\n        }\n\n        var diff = Math.abs(Math.max(one, two) - Math.min(one, two));\n\n        if (diff < impliedBandWidth) {\n          impliedBandWidth = diff;\n        }\n      });\n    });\n  });\n  var bandRange = Math.max.apply(Math, range);\n  var bandDomain = d3Range(bandRange / impliedBandWidth);\n  var primaryBandScale = scaleBand(bandDomain, range).round(false).paddingOuter((_options$outerBandPad3 = options.outerBandPadding) != null ? _options$outerBandPad3 : 0).paddingInner((_options$innerBandPad3 = options.innerBandPadding) != null ? _options$innerBandPad3 : 0);\n  return primaryBandScale;\n}\n\nfunction buildSeriesBandScale(options, primaryBandScale, series) {\n  var _options$outerSeriesB2, _options$innerSeriesB2;\n\n  var bandDomain = d3Range(series.filter(function (d) {\n    return d.secondaryAxisId === options.id;\n  }).length);\n  var seriesBandScale = scaleBand(bandDomain, [0, primaryBandScale.bandwidth()]).round(false).paddingOuter((_options$outerSeriesB2 = options.outerSeriesBandPadding) != null ? _options$outerSeriesB2 : options.outerBandPadding ? options.outerBandPadding / 2 : 0).paddingInner((_options$innerSeriesB2 = options.innerSeriesBandPadding) != null ? _options$innerSeriesB2 : options.innerBandPadding ? options.innerBandPadding / 2 : 0);\n\n  var scale = function scale(seriesIndex) {\n    var _series$find;\n\n    return seriesBandScale((_series$find = series.find(function (d) {\n      return d.index === seriesIndex;\n    })) == null ? void 0 : _series$find.indexPerAxis);\n  };\n\n  return Object.assign(scale, seriesBandScale);\n}"]},"metadata":{},"sourceType":"module"}